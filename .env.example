# OpenRouter Configuration
OPENAI_API_BASE=https://openrouter.ai/api/v1
OPENAI_API_KEY=your-openrouter-api-key-here
MODEL_NAME=qwen/qwen3-max

# Application Settings
LOG_LEVEL=INFO
SESSION_TTL_SECONDS=3600
ENVIRONMENT=development

# Streaming Configuration (FR-014: SSE idle timeout)
# Maximum seconds of stream inactivity before timeout
# Note: This is IDLE timeout (no events), not total execution time
# Allows long-running queries as long as events keep arriving
STREAM_IDLE_TIMEOUT=30

# Embedding Configuration
# NOTE: Embeddings must be pre-computed before starting the service
# Run these commands once before first startup:
#   python -m src.precompute_embeddings
#   python -m src.precompute_parenting_embeddings --force
#
# Optional: Override embedding paths (defaults shown)
# INDEX_PATH=data/embeddings/
# PARENTING_INDEX_PATH=data/parenting_index

# Chunking System Configuration
OPENROUTER_API_KEY=your-openrouter-api-key-here
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1
CACHE_DIR=.cache

# PostgreSQL Configuration (002-semantic-search)
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=medical_knowledge
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres

# Database connection string
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/medical_knowledge

# ========================================
# Embedding Provider Configuration (004-cloud-embedding-refactor)
# ========================================
# EMBEDDING_PROVIDER controls which embedding service to use
# Options: "local" (Qwen3 on MPS/CUDA/CPU), "openrouter" (OpenRouter API), "aliyun" (Aliyun DashScope)
EMBEDDING_PROVIDER=local

# Provider-specific API Keys (only required for cloud providers)
# OPENAI_API_KEY: Required for EMBEDDING_PROVIDER=openrouter
# ALIYUN_API_KEY: Required for EMBEDDING_PROVIDER=aliyun
# Not required for EMBEDDING_PROVIDER=local
# OPENAI_API_KEY=your-openrouter-api-key-here
# ALIYUN_API_KEY=your-aliyun-api-key-here

# Embedding Dimension (must match database schema)
# All providers use 1024-dimensional embeddings
EMBEDDING_DIM=1024

# Embedding Table Name (PostgreSQL table for vector storage)
TABLE_NAME=vector_chunks

# ========================================
# Local Embedding Provider Configuration
# ========================================
# Only used when EMBEDDING_PROVIDER=local
SEMANTIC_EMBEDDING_MODEL=Qwen/Qwen3-Embedding-0.6B
SEMANTIC_EMBEDDING_DEVICE=mps
SEMANTIC_EMBEDDING_BATCH_SIZE=16
SEMANTIC_EMBEDDING_MAX_LENGTH=1024

# ========================================
# Reranker Configuration
# ========================================
SEMANTIC_RERANKER_MODEL=Qwen/Qwen3-Reranker-0.6B
SEMANTIC_RERANKER_DEVICE=mps
SEMANTIC_RERANKER_BATCH_SIZE=1
SEMANTIC_RERANKER_TOP_K=5
SEMANTIC_RERANKER_CANDIDATE_COUNT=20

# Retrieval Strategy Configuration
# Options: "simple" (no reranking), "rerank" (two-stage), "advanced" (query expansion + rerank)
RETRIEVAL_STRATEGY=simple

# Model Loading Configuration
# True = load models at startup, False = lazy load on first use
PRELOAD_MODELS=False

# Feature Flags
# Temporarily disable parenting system to focus on medication Q&A POC
ENABLE_PARENTING=False
# Enable database retry logic (False for POC to fail fast)
ENABLE_RETRIES=False

# Model Names (standardized uppercase constants)
EMBEDDING_MODEL=Qwen/Qwen3-Embedding-0.6B
RERANKER_MODEL=Qwen/Qwen3-Reranker-0.6B
